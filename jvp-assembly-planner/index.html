<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jamna Vidyapeeth - Assembly Scheduler</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary: #1e3a8a;
            --primary-light: #3b82f6;
            --secondary: #f59e0b;
            --success: #10b981;
            --danger: #ef4444;
            --light: #f3f4f6;
            --dark: #1f2937;
            --text: #374151;
            --border: #d1d5db;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f8fafc;
            color: var(--text);
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        header {
            background-color: var(--primary);
            color: white;
            padding: 1rem 0;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .header-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .school-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .logo {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid white;
        }

        .school-name {
            font-size: 1.5rem;
            font-weight: 700;
        }

        main {
            padding: 2rem 0;
        }

        .card {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        h2 {
            color: var(--primary);
            margin-bottom: 1.5rem;
            font-size: 1.5rem;
            border-bottom: 2px solid var(--light);
            padding-bottom: 0.5rem;
        }

        .auth-form {
            max-width: 400px;
            margin: 3rem auto;
        }

        .form-group {
            margin-bottom: 1.25rem;
        }

        label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--dark);
        }

        input, select, textarea {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid var(--border);
            border-radius: 4px;
            font-size: 1rem;
            color: var(--text);
            transition: border-color 0.3s;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--primary-light);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .btn {
            display: inline-block;
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 4px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }

        .btn-primary {
            background-color: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background-color: #1e40af;
        }

        .btn-secondary {
            background-color: var(--secondary);
            color: white;
        }

        .btn-secondary:hover {
            background-color: #d97706;
        }

        .btn-success {
            background-color: var(--success);
            color: white;
        }

        .btn-success:hover {
            background-color: #059669;
        }

        .btn-danger {
            background-color: var(--danger);
            color: white;
        }

        .btn-danger:hover {
            background-color: #dc2626;
        }

        .btn-block {
            display: block;
            width: 100%;
        }

        .form-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1.25rem;
        }

        @media (min-width: 768px) {
            .form-grid {
                grid-template-columns: 1fr 1fr;
            }
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        .separator {
            text-align: center;
            margin: 1.5rem 0;
            position: relative;
        }

        .separator::before {
            content: "";
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 1px;
            background-color: var(--border);
            z-index: 1;
        }

        .separator span {
            position: relative;
            z-index: 2;
            background-color: white;
            padding: 0 1rem;
            color: var(--text);
            font-size: 0.875rem;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1.5rem;
            overflow-x: auto;
        }

        th, td {
            padding: 0.75rem;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }

        th {
            background-color: var(--light);
            font-weight: 600;
            color: var(--dark);
        }

        tbody tr:hover {
            background-color: #f9fafb;
        }

        .table-responsive {
            overflow-x: auto;
        }

        .badge {
            display: inline-block;
            padding: 0.25rem 0.5rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 500;
            text-align: center;
        }

        .badge-primary {
            background-color: #dbeafe;
            color: var(--primary);
        }

        .badge-secondary {
            background-color: #fef3c7;
            color: #92400e;
        }

        .flex {
            display: flex;
        }

        .items-center {
            align-items: center;
        }

        .justify-between {
            justify-content: space-between;
        }

        .gap-2 {
            gap: 0.5rem;
        }

        .gap-4 {
            gap: 1rem;
        }

        .mt-4 {
            margin-top: 1rem;
        }

        .mb-2 {
            margin-bottom: 0.5rem;
        }

        .hidden {
            display: none;
        }

        .ai-suggestion {
            background-color: #f0f9ff;
            border-left: 4px solid var(--primary-light);
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 4px;
        }

        .additional-roles {
            margin-top: 1rem;
            padding: 1rem;
            background-color: #f9fafb;
            border-radius: 4px;
            border: 1px dashed var(--border);
        }

        .role-entry {
            display: flex;
            gap: 1rem;
            margin-bottom: 0.75rem;
            align-items: center;
        }

        .role-entry input {
            flex: 1;
        }

        .role-remove {
            color: var(--danger);
            cursor: pointer;
            font-size: 1.25rem;
        }

        footer {
            background-color: var(--dark);
            color: white;
            padding: 1.5rem 0;
            margin-top: 3rem;
            text-align: center;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 100;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background-color: white;
            padding: 2rem;
            border-radius: 8px;
            max-width: 500px;
            width: 100%;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
            position: relative;
        }

        .modal-close {
            position: absolute;
            top: 1rem;
            right: 1rem;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text);
        }

        .ai-options {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .ai-option {
            padding: 1rem;
            border-radius: 6px;
            border: 1px solid var(--border);
            cursor: pointer;
            transition: all 0.2s;
        }

        .ai-option:hover {
            border-color: var(--primary-light);
            background-color: #f0f9ff;
        }

        .toast {
            position: fixed;
            top: 1rem;
            right: 1rem;
            padding: 1rem 1.5rem;
            background-color: var(--success);
            color: white;
            border-radius: 4px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
        }

        .toast.show {
            opacity: 1;
        }

        .text-center {
            text-align: center;
        }

        /* Empty state styles */
        .empty-state {
            text-align: center;
            padding: 2rem;
            background-color: #f9fafb;
            border-radius: 8px;
            border: 1px dashed var(--border);
        }

        .empty-state i {
            font-size: 3rem;
            color: var(--border);
            margin-bottom: 1rem;
        }

        .empty-state h3 {
            color: var(--dark);
            margin-bottom: 0.5rem;
        }

        .empty-state p {
            color: var(--text);
        }
    </style>
</head>
<body>
    <header>
        <div class="container header-content">
            <div class="school-info">
                <img src="https://i.postimg.cc/Y0qB2Wyc/images-2024-05-21-T183208-408.jpg" alt="Jamna Vidyapeeth Logo" class="logo">
                <div>
                    <div class="school-name">Jamna Vidyapeeth</div>
                    <div>Assembly Scheduler</div>
                </div>
            </div>
        </div>
    </header>

    <main>
        <div class="container">
            <div class="auth-form card" id="authForm">
                <h2 class="text-center">Teacher Authentication</h2>
                <div class="form-group">
                    <label for="passkey">Enter Passkey</label>
                    <input type="password" id="passkey" placeholder="Enter your passkey">
                </div>
                <button class="btn btn-primary btn-block" id="authenticateBtn">Authenticate</button>
            </div>

            <div class="card hidden" id="schedulerForm">
                <h2>Schedule Morning Assembly</h2>
                <form id="assemblyForm">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="assemblyDate">Assembly Date</label>
                            <input type="date" id="assemblyDate" required>
                        </div>
                        <div class="form-group">
                            <label for="theme">Theme/Topic</label>
                            <input type="text" id="theme" placeholder="Enter assembly theme/topic" required>
                            <button type="button" class="btn btn-secondary mt-4" id="suggestThemeBtn">
                                <i class="fas fa-lightbulb"></i> Get AI Suggestions
                            </button>
                        </div>
                        <div class="form-group">
                            <label for="conductingClass">Conducting Class</label>
                            <select id="conductingClass" required>
                                <option value="">-- Select Class --</option>
                                </select>
                        </div>
                        <div class="form-group">
                            <label for="anchorStudent">Anchoring By</label>
                            <input type="text" id="anchorStudent" placeholder="Student Name" required>
                        </div>
                        <div class="form-group">
                            <label for="thoughtStudent">Thought of the Day By</label>
                            <input type="text" id="thoughtStudent" placeholder="Student Name" required>
                        </div>
                        <div class="form-group">
                            <label for="thought">Thought of the Day</label>
                            <input type="text" id="thought" placeholder="Enter thought of the day">
                            <button type="button" class="btn btn-secondary mt-4" id="suggestThoughtBtn">
                                <i class="fas fa-lightbulb"></i> Get AI Suggestions
                            </button>
                        </div>
                        <div class="form-group">
                            <label for="wordStudent">Word of the Day By</label>
                            <input type="text" id="wordStudent" placeholder="Student Name" required>
                        </div>
                        <div class="form-group">
                            <label for="word">Word of the Day</label>
                            <input type="text" id="word" placeholder="Enter word of the day">
                            <button type="button" class="btn btn-secondary mt-4" id="suggestWordBtn">
                                <i class="fas fa-lightbulb"></i> Get AI Suggestions
                            </button>
                        </div>
                        <div class="form-group">
                            <label for="newsStudent">News Reading By</label>
                            <input type="text" id="newsStudent" placeholder="Student Name" required>
                        </div>
                    </div>

                    <div class="form-group full-width">
                        <div class="flex justify-between items-center">
                            <label>Additional Roles (Optional)</label>
                            <button type="button" class="btn btn-primary" id="addRoleBtn">
                                <i class="fas fa-plus"></i> Add Role
                            </button>
                        </div>
                        <div id="additionalRoles" class="additional-roles hidden">
                            </div>
                    </div>

                    <div class="form-group full-width">
                        <button type="submit" class="btn btn-success btn-block">
                            <i class="fas fa-calendar-check"></i> Schedule Assembly
                        </button>
                    </div>
                </form>
            </div>

            <div class="card hidden" id="upcomingAssemblies">
                <h2>Upcoming Assemblies</h2>
                <div class="table-responsive">
                    <table id="assembliesTable">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Theme</th>
                                <th>Class</th>
                                <th>Anchoring By</th>
                                <th>Thought of the Day</th>
                                <th>Word of the Day</th>
                                <th>News By</th>
                                <th>Additional Roles</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="assembliesTableBody">
                            </tbody>
                    </table>
                    <div class="empty-state" id="emptyState">
                        <i class="fas fa-calendar-day"></i>
                        <h3>No Assemblies Scheduled Yet</h3>
                        <p>Start by scheduling your first assembly above.</p>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer>
        <div class="container">
            <p>Crafted by Sourabh Sir with ♥️</p>
        </div>
    </footer>

    <div class="modal" id="aiModal">
        <div class="modal-content">
            <span class="modal-close" id="closeAiModal">&times;</span>
            <h2 id="aiModalTitle">AI Assistance</h2>
            <p id="aiModalDescription">Select one of the suggestions below:</p>
            <div class="ai-options" id="aiOptions">
            </div>
        </div>
    </div>

    <div class="toast" id="toast"></div>

    <script>
        const PASSKEY = "jvp123";
        let assemblies = [];
        let additionalRolesCount = 0;

        const authForm = document.getElementById('authForm');
        const schedulerForm = document.getElementById('schedulerForm');
        const upcomingAssemblies = document.getElementById('upcomingAssemblies');
        const passKeyInput = document.getElementById('passkey');
        const authenticateBtn = document.getElementById('authenticateBtn');
        const assemblyForm = document.getElementById('assemblyForm');
        const conductingClassSelect = document.getElementById('conductingClass');
        const addRoleBtn = document.getElementById('addRoleBtn');
        const additionalRolesDiv = document.getElementById('additionalRoles');
        const assembliesTableBody = document.getElementById('assembliesTableBody');
        const emptyState = document.getElementById('emptyState');
        const aiModal = document.getElementById('aiModal');
        const closeAiModal = document.getElementById('closeAiModal');
        const aiOptions = document.getElementById('aiOptions');
        const aiModalTitle = document.getElementById('aiModalTitle');
        const aiModalDescription = document.getElementById('aiModalDescription');
        const toast = document.getElementById('toast');
        const suggestThemeBtn = document.getElementById('suggestThemeBtn');
        const suggestThoughtBtn = document.getElementById('suggestThoughtBtn');
        const suggestWordBtn = document.getElementById('suggestWordBtn');

        function init() {
            populateClasses();
            loadAssembliesFromStorage();
            updateAssembliesTable();
            setupEventListeners();
        }

        function populateClasses() {
            const classes = [];
            for (let grade = 1; grade <= 12; grade++) {
                for (let section = 1; section <= 4; section++) {
                    classes.push(`${grade}-A${section}`);
                }
            }

            classes.forEach(className => {
                const option = document.createElement('option');
                option.value = className;
                option.textContent = className;
                conductingClassSelect.appendChild(option);
            });
        }

        function loadAssembliesFromStorage() {
            const storedAssemblies = localStorage.getItem('jvAssemblies');
            if (storedAssemblies) {
                assemblies = JSON.parse(storedAssemblies);
            }
        }

        function saveAssembliesToStorage() {
            localStorage.setItem('jvAssemblies', JSON.stringify(assemblies));
        }

        function updateAssembliesTable() {
            assembliesTableBody.innerHTML = '';

            const sortedAssemblies = [...assemblies].sort((a, b) => new Date(a.date) - new Date(b.date));
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            const futureAssemblies = sortedAssemblies.filter(assembly => new Date(assembly.date) >= today);
            const upcomingAssemblies = futureAssemblies.slice(0, 10);

            if (upcomingAssemblies.length === 0) {
                emptyState.classList.remove('hidden');
            } else {
                emptyState.classList.add('hidden');
            }

            upcomingAssemblies.forEach((assembly, index) => {
                const row = document.createElement('tr');
                const date = new Date(assembly.date);
                const formattedDate = date.toLocaleDateString('en-US', {
                    weekday: 'short',
                    year: 'numeric',
                    month: 'short',
                    day: 'numeric'
                });

                let additionalRolesHTML = '';
                if (assembly.additional_roles && assembly.additional_roles.length > 0) {
                    additionalRolesHTML = assembly.additional_roles.map(role => `<span class="badge badge-secondary">${role.role}: ${role.student}</span>`).join(' ');
                } else {
                    additionalRolesHTML = '—';
                }

                row.innerHTML = `
                    <td>${formattedDate}</td>
                    <td>${assembly.theme}</td>
                    <td><span class="badge badge-primary">${assembly.conducting_class}</span></td>
                    <td>${assembly.anchoring_by}</td>
                    <td>${assembly.thought || '—'}</td>
                    <td>${assembly.word_of_the_day || '—'}</td>
                    <td>${assembly.news_by}</td>
                    <td>${additionalRolesHTML}</td>
                    <td>
                        <button class="btn btn-danger btn-sm" onclick="deleteAssembly('${assembly.date}')"><i class="fas fa-trash"></i></button>
                    </td>
                `;
                assembliesTableBody.appendChild(row);
            });
        }

        function setupEventListeners() {
            authenticateBtn.addEventListener('click', handleAuthentication);
            assemblyForm.addEventListener('submit', handleFormSubmit);
            addRoleBtn.addEventListener('click', addRole);
            suggestThemeBtn.addEventListener('click', () => showAiSuggestions('theme'));
            suggestThoughtBtn.addEventListener('click', () => showAiSuggestions('thought'));
            suggestWordBtn.addEventListener('click', () => showAiSuggestions('word'));
            closeAiModal.addEventListener('click', hideAiModal);
        }

        function handleAuthentication() {
            const enteredPasskey = passKeyInput.value.trim();
            if (enteredPasskey === PASSKEY) {
                authForm.classList.add('hidden');
                schedulerForm.classList.remove('hidden');
                upcomingAssemblies.classList.remove('hidden');
                showToast('Authentication successful!');
            } else {
                showToast('Invalid passkey! Please try again.', 'error');
                passKeyInput.value = '';
                passKeyInput.focus();
            }
        }

        function handleFormSubmit(event) {
            event.preventDefault();

            const assemblyDate = document.getElementById('assemblyDate').value;
            const existingIndex = assemblies.findIndex(assembly => assembly.date === assemblyDate);

            const newAssemblyData = {
                date: assemblyDate,
                theme: document.getElementById('theme').value,
                conducting_class: document.getElementById('conductingClass').value,
                anchoring_by: document.getElementById('anchorStudent').value,
                thought_by: document.getElementById('thoughtStudent').value,
                thought: document.getElementById('thought').value || null,
                word_student: document.getElementById('wordStudent').value,
                word_of_the_day: document.getElementById('word').value || null,
                news_by: document.getElementById('newsStudent').value,
                additional_roles: []
            };

            const roleEntries = document.querySelectorAll('.role-entry');
            roleEntries.forEach(entry => {
                const roleInput = entry.querySelector('.role-name');
                const studentInput = entry.querySelector('.role-student');

                if (roleInput.value && studentInput.value) {
                    newAssemblyData.additional_roles.push({
                        role: roleInput.value,
                        student: studentInput.value
                    });
                }
            });

            if (existingIndex !== -1) {
                assemblies[existingIndex] = newAssemblyData;
                showToast('Assembly schedule updated successfully!');
            } else {
                assemblies.push(newAssemblyData);
                showToast('Assembly scheduled successfully!');
            }

            saveAssembliesToStorage();
            updateAssembliesTable();
            assemblyForm.reset();
            resetAdditionalRoles();
        }

        function deleteAssembly(dateToDelete) {
            if (confirm('Are you sure you want to delete the assembly scheduled for ' + new Date(dateToDelete).toLocaleDateString() + '?')) {
                assemblies = assemblies.filter(assembly => assembly.date !== dateToDelete);
                saveAssembliesToStorage();
                updateAssembliesTable();
                showToast('Assembly deleted successfully!');
            }
        }

        function addRole() {
            additionalRolesCount++;
            if (additionalRolesDiv.classList.contains('hidden')) {
                additionalRolesDiv.classList.remove('hidden');
            }
            const roleEntry = document.createElement('div');
            roleEntry.className = 'role-entry';
            roleEntry.innerHTML = `
                <input type="text" class="role-name" placeholder="Role Name" required>
                <input type="text" class="role-student" placeholder="Student Name" required>
                <span class="role-remove" onclick="removeRole(this)">
                    <i class="fas fa-times-circle"></i>
                </span>
            `;
            additionalRolesDiv.appendChild(roleEntry);
        }

        function removeRole(element) {
            const roleEntry = element.parentElement;
            roleEntry.remove();
            additionalRolesCount--;
            if (additionalRolesCount === 0) {
                additionalRolesDiv.classList.add('hidden');
            }
        }

        function resetAdditionalRoles() {
            additionalRolesDiv.innerHTML = '';
            additionalRolesCount = 0;
            additionalRolesDiv.classList.add('hidden');
        }

        function showAiSuggestions(type) {
            aiOptions.innerHTML = '';
            let title = '';
            let description = '';
            let suggestions = [];

            switch (type) {
                case 'theme':
                    title = 'Assembly Theme Suggestions';
                    description = 'Select a theme for your assembly:';
                    suggestions = [
                        'Environmental Awareness: Reduce, Reuse, Recycle',
                        'Unity in Diversity: Celebrating Our Differences',
                        'Digital Citizenship: Being Responsible Online',
                        'Health and Wellness: Mind, Body, and Spirit',
                        'Leadership and Teamwork: Together We Achieve More'
                    ];
                    break;

                case 'thought':
                    title = 'Thought of the Day Suggestions';
                    description = 'Select a thought for your assembly:';
                    suggestions = [
                        'Education is not the filling of a pail, but the lighting of a fire.',
                        'The future belongs to those who believe in the beauty of their dreams.',
                        'The only way to do great work is to love what you do.',
                        'Success is not final, failure is not fatal: It is the courage to continue that counts.',
                        'Be the change that you wish to see in the world.'
                    ];
                    break;

                case 'word':
                    title = 'Word of the Day Suggestions';
                    description = 'Select a word for your assembly:';
                    suggestions = [
                        'Perseverance - Persistence in doing something despite difficulty or delay in achieving success.',
                        'Integrity - The quality of being honest and having strong moral principles.',
                        'Resilience - The capacity to recover quickly from difficulties; toughness.',
                        'Empathy - The ability to understand and share the feelings of another.',
                        'Innovation - The action or process of innovating; a new method, idea, product, etc.'
                    ];
                    break;
            }

            aiModalTitle.textContent = title;
            aiModalDescription.textContent = description;

            suggestions.forEach((suggestion, index) => {
                const option = document.createElement('div');
                option.className = 'ai-option';
                option.textContent = suggestion;
                option.addEventListener('click', () => {
                    selectAiSuggestion(type, suggestion);
                    hideAiModal();
                });
                aiOptions.appendChild(option);
            });

            aiModal.style.display = 'flex';
        }

        function hideAiModal() {
            aiModal.style.display = 'none';
        }

        function selectAiSuggestion(type, suggestion) {
            switch (type) {
                case 'theme':
                    document.getElementById('theme').value = suggestion;
                    break;

                case 'thought':
                    document.getElementById('thought').value = suggestion;
                    break;

                case 'word':
                    const wordPart = suggestion.split(' - ')[0];
                    document.getElementById('word').value = wordPart;
                    break;
            }
        }

        function showToast(message, type = 'success') {
            toast.textContent = message;
            toast.className = `toast show ${type === 'error' ? 'toast-error' : ''}`;
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        init();
    </script>
</body>
</html>
